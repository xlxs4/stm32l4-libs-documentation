<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32L4xx_HAL_Driver: IO operation functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STM32L4xx_HAL_Driver
   &#160;<span id="projectnumber">1.14.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__SPI__Exported__Functions__Group2.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">IO operation functions<div class="ingroups"><a class="el" href="group__STM32L4xx__HAL__Driver.html">STM32L4xx_HAL_Driver</a> &raquo; <a class="el" href="group__SPI.html">SPI</a> &raquo; <a class="el" href="group__SPI__Exported__Functions.html">SPI Exported Functions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Data transfers functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga02ec86e05d0702387c221f90b6f041a2"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga02ec86e05d0702387c221f90b6f041a2">HAL_SPI_Transmit</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size, uint32_t Timeout)</td></tr>
<tr class="memdesc:ga02ec86e05d0702387c221f90b6f041a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit an amount of data in blocking mode.  <a href="group__SPI__Exported__Functions__Group2.html#ga02ec86e05d0702387c221f90b6f041a2">More...</a><br /></td></tr>
<tr class="separator:ga02ec86e05d0702387c221f90b6f041a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdf43dbe4e5ef225bed6650b6e8c6313"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gafdf43dbe4e5ef225bed6650b6e8c6313">HAL_SPI_Receive</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size, uint32_t Timeout)</td></tr>
<tr class="memdesc:gafdf43dbe4e5ef225bed6650b6e8c6313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive an amount of data in blocking mode.  <a href="group__SPI__Exported__Functions__Group2.html#gafdf43dbe4e5ef225bed6650b6e8c6313">More...</a><br /></td></tr>
<tr class="separator:gafdf43dbe4e5ef225bed6650b6e8c6313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c3106fe01493a33b08e5c617f45aeb1"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga7c3106fe01493a33b08e5c617f45aeb1">HAL_SPI_TransmitReceive</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size, uint32_t Timeout)</td></tr>
<tr class="memdesc:ga7c3106fe01493a33b08e5c617f45aeb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit and Receive an amount of data in blocking mode.  <a href="group__SPI__Exported__Functions__Group2.html#ga7c3106fe01493a33b08e5c617f45aeb1">More...</a><br /></td></tr>
<tr class="separator:ga7c3106fe01493a33b08e5c617f45aeb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbb309aa738bb3296934fb1a39ffbf40"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gafbb309aa738bb3296934fb1a39ffbf40">HAL_SPI_Transmit_IT</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size)</td></tr>
<tr class="memdesc:gafbb309aa738bb3296934fb1a39ffbf40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit an amount of data in non-blocking mode with Interrupt.  <a href="group__SPI__Exported__Functions__Group2.html#gafbb309aa738bb3296934fb1a39ffbf40">More...</a><br /></td></tr>
<tr class="separator:gafbb309aa738bb3296934fb1a39ffbf40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaae0af2e2db7e7549b52b020a18f6168"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaaae0af2e2db7e7549b52b020a18f6168">HAL_SPI_Receive_IT</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size)</td></tr>
<tr class="memdesc:gaaae0af2e2db7e7549b52b020a18f6168"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive an amount of data in non-blocking mode with Interrupt.  <a href="group__SPI__Exported__Functions__Group2.html#gaaae0af2e2db7e7549b52b020a18f6168">More...</a><br /></td></tr>
<tr class="separator:gaaae0af2e2db7e7549b52b020a18f6168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga518c43d8323499451e7f4782a9dc6e32"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga518c43d8323499451e7f4782a9dc6e32">HAL_SPI_TransmitReceive_IT</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size)</td></tr>
<tr class="memdesc:ga518c43d8323499451e7f4782a9dc6e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit and Receive an amount of data in non-blocking mode with Interrupt.  <a href="group__SPI__Exported__Functions__Group2.html#ga518c43d8323499451e7f4782a9dc6e32">More...</a><br /></td></tr>
<tr class="separator:ga518c43d8323499451e7f4782a9dc6e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6aebe304396c3e18b55f926dae0dadcb"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga6aebe304396c3e18b55f926dae0dadcb">HAL_SPI_Transmit_DMA</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size)</td></tr>
<tr class="memdesc:ga6aebe304396c3e18b55f926dae0dadcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit an amount of data in non-blocking mode with DMA.  <a href="group__SPI__Exported__Functions__Group2.html#ga6aebe304396c3e18b55f926dae0dadcb">More...</a><br /></td></tr>
<tr class="separator:ga6aebe304396c3e18b55f926dae0dadcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga626bb2ec54e7b6ff9bd5d807ae6e6e24"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga626bb2ec54e7b6ff9bd5d807ae6e6e24">HAL_SPI_Receive_DMA</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pData, uint16_t Size)</td></tr>
<tr class="memdesc:ga626bb2ec54e7b6ff9bd5d807ae6e6e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive an amount of data in non-blocking mode with DMA.  <a href="group__SPI__Exported__Functions__Group2.html#ga626bb2ec54e7b6ff9bd5d807ae6e6e24">More...</a><br /></td></tr>
<tr class="separator:ga626bb2ec54e7b6ff9bd5d807ae6e6e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga228553c64b10b8dade9fee525a8a489d"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga228553c64b10b8dade9fee525a8a489d">HAL_SPI_TransmitReceive_DMA</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size)</td></tr>
<tr class="memdesc:ga228553c64b10b8dade9fee525a8a489d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit and Receive an amount of data in non-blocking mode with DMA.  <a href="group__SPI__Exported__Functions__Group2.html#ga228553c64b10b8dade9fee525a8a489d">More...</a><br /></td></tr>
<tr class="separator:ga228553c64b10b8dade9fee525a8a489d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61e4a628d6918ec838736d65ae135031"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga61e4a628d6918ec838736d65ae135031">HAL_SPI_DMAPause</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga61e4a628d6918ec838736d65ae135031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pause the DMA Transfer.  <a href="group__SPI__Exported__Functions__Group2.html#ga61e4a628d6918ec838736d65ae135031">More...</a><br /></td></tr>
<tr class="separator:ga61e4a628d6918ec838736d65ae135031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fdd4b7aa5c6bd560a476c833f546d93"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga7fdd4b7aa5c6bd560a476c833f546d93">HAL_SPI_DMAResume</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga7fdd4b7aa5c6bd560a476c833f546d93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume the DMA Transfer.  <a href="group__SPI__Exported__Functions__Group2.html#ga7fdd4b7aa5c6bd560a476c833f546d93">More...</a><br /></td></tr>
<tr class="separator:ga7fdd4b7aa5c6bd560a476c833f546d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e01eb529af91fabc950180b927fa355"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga7e01eb529af91fabc950180b927fa355">HAL_SPI_DMAStop</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga7e01eb529af91fabc950180b927fa355"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the DMA Transfer.  <a href="group__SPI__Exported__Functions__Group2.html#ga7e01eb529af91fabc950180b927fa355">More...</a><br /></td></tr>
<tr class="separator:ga7e01eb529af91fabc950180b927fa355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11c74b1d91d88ff336f674f6376cc904"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga11c74b1d91d88ff336f674f6376cc904">HAL_SPI_Abort</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga11c74b1d91d88ff336f674f6376cc904"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort ongoing transfer (blocking mode).  <a href="group__SPI__Exported__Functions__Group2.html#ga11c74b1d91d88ff336f674f6376cc904">More...</a><br /></td></tr>
<tr class="separator:ga11c74b1d91d88ff336f674f6376cc904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75d7782876ed13b9f8aebfa8dbba5a1c"><td class="memItemLeft" align="right" valign="top">HAL_StatusTypeDef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga75d7782876ed13b9f8aebfa8dbba5a1c">HAL_SPI_Abort_IT</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga75d7782876ed13b9f8aebfa8dbba5a1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort ongoing transfer (Interrupt mode).  <a href="group__SPI__Exported__Functions__Group2.html#ga75d7782876ed13b9f8aebfa8dbba5a1c">More...</a><br /></td></tr>
<tr class="separator:ga75d7782876ed13b9f8aebfa8dbba5a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3da6e0a87468bc039b578c21329df47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaf3da6e0a87468bc039b578c21329df47">HAL_SPI_IRQHandler</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaf3da6e0a87468bc039b578c21329df47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle SPI interrupt request.  <a href="group__SPI__Exported__Functions__Group2.html#gaf3da6e0a87468bc039b578c21329df47">More...</a><br /></td></tr>
<tr class="separator:gaf3da6e0a87468bc039b578c21329df47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba27e527ac90813300e6033f639079ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaba27e527ac90813300e6033f639079ef">HAL_SPI_TxCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaba27e527ac90813300e6033f639079ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tx Transfer completed callback.  <a href="group__SPI__Exported__Functions__Group2.html#gaba27e527ac90813300e6033f639079ef">More...</a><br /></td></tr>
<tr class="separator:gaba27e527ac90813300e6033f639079ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga588e410e39147f920166b77220691c5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga588e410e39147f920166b77220691c5a">HAL_SPI_RxCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga588e410e39147f920166b77220691c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rx Transfer completed callback.  <a href="group__SPI__Exported__Functions__Group2.html#ga588e410e39147f920166b77220691c5a">More...</a><br /></td></tr>
<tr class="separator:ga588e410e39147f920166b77220691c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b79c3829364ec69cd17622b0cdbc00f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#ga6b79c3829364ec69cd17622b0cdbc00f">HAL_SPI_TxRxCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:ga6b79c3829364ec69cd17622b0cdbc00f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tx and Rx Transfer completed callback.  <a href="group__SPI__Exported__Functions__Group2.html#ga6b79c3829364ec69cd17622b0cdbc00f">More...</a><br /></td></tr>
<tr class="separator:ga6b79c3829364ec69cd17622b0cdbc00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae199977f796bd5d33fb59d3cd3aff6a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gae199977f796bd5d33fb59d3cd3aff6a3">HAL_SPI_TxHalfCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gae199977f796bd5d33fb59d3cd3aff6a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tx Half Transfer completed callback.  <a href="group__SPI__Exported__Functions__Group2.html#gae199977f796bd5d33fb59d3cd3aff6a3">More...</a><br /></td></tr>
<tr class="separator:gae199977f796bd5d33fb59d3cd3aff6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3b631cebfadace006e5ea8e5352743a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaf3b631cebfadace006e5ea8e5352743a">HAL_SPI_RxHalfCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaf3b631cebfadace006e5ea8e5352743a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rx Half Transfer completed callback.  <a href="group__SPI__Exported__Functions__Group2.html#gaf3b631cebfadace006e5ea8e5352743a">More...</a><br /></td></tr>
<tr class="separator:gaf3b631cebfadace006e5ea8e5352743a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2ad9005465537b745e151e722df7c5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaf2ad9005465537b745e151e722df7c5b">HAL_SPI_TxRxHalfCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaf2ad9005465537b745e151e722df7c5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tx and Rx Half Transfer callback.  <a href="group__SPI__Exported__Functions__Group2.html#gaf2ad9005465537b745e151e722df7c5b">More...</a><br /></td></tr>
<tr class="separator:gaf2ad9005465537b745e151e722df7c5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb4c01bcfbd998bd56cad9e4253399de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaeb4c01bcfbd998bd56cad9e4253399de">HAL_SPI_ErrorCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaeb4c01bcfbd998bd56cad9e4253399de"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI error callback.  <a href="group__SPI__Exported__Functions__Group2.html#gaeb4c01bcfbd998bd56cad9e4253399de">More...</a><br /></td></tr>
<tr class="separator:gaeb4c01bcfbd998bd56cad9e4253399de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf72fd0e437ebae7dc854ea20a2322c80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SPI__Exported__Functions__Group2.html#gaf72fd0e437ebae7dc854ea20a2322c80">HAL_SPI_AbortCpltCallback</a> (<a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *hspi)</td></tr>
<tr class="memdesc:gaf72fd0e437ebae7dc854ea20a2322c80"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Abort Complete callback.  <a href="group__SPI__Exported__Functions__Group2.html#gaf72fd0e437ebae7dc854ea20a2322c80">More...</a><br /></td></tr>
<tr class="separator:gaf72fd0e437ebae7dc854ea20a2322c80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Data transfers functions. </p>
<pre class="fragment">  ==============================================================================
                      ##### IO operation functions #####
 ===============================================================================
 [..]
    This subsection provides a set of functions allowing to manage the SPI
    data transfers.

    [..] The SPI supports master and slave mode :

    (#) There are two modes of transfer:
       (++) Blocking mode: The communication is performed in polling mode.
            The HAL status of all data processing is returned by the same function
            after finishing transfer.
       (++) No-Blocking mode: The communication is performed using Interrupts
            or DMA, These APIs return the HAL status.
            The end of the data processing will be indicated through the
            dedicated SPI IRQ when using Interrupt mode or the DMA IRQ when
            using DMA mode.
            The HAL_SPI_TxCpltCallback(), HAL_SPI_RxCpltCallback() and HAL_SPI_TxRxCpltCallback() user callbacks
            will be executed respectively at the end of the transmit or Receive process
            The HAL_SPI_ErrorCallback()user callback will be executed when a communication error is detected

    (#) APIs provided for these 2 transfer modes (Blocking mode or Non blocking mode using either Interrupt or DMA)
        exist for 1Line (simplex) and 2Lines (full duplex) modes.</pre> <h2 class="groupheader">Function Documentation</h2>
<a id="ga11c74b1d91d88ff336f674f6376cc904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11c74b1d91d88ff336f674f6376cc904">&#9670;&nbsp;</a></span>HAL_SPI_Abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort ongoing transfer (blocking mode). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>SPI handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This procedure could be used for aborting any ongoing transfer (Tx and Rx), started in Interrupt or DMA mode. This procedure performs following operations :<ul>
<li>Disable SPI Interrupts (depending of transfer direction)</li>
<li>Disable the DMA transfer in the peripheral register (if enabled)</li>
<li>Abort DMA transfer by calling HAL_DMA_Abort (in case of transfer in DMA mode)</li>
<li>Set handle State to READY </li>
</ul>
</dd>
<dd>
This procedure is executed in blocking mode : when exiting function, Abort is considered as completed. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02246">2246</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;{</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  HAL_StatusTypeDef errorcode;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  __IO uint32_t count, resetcount;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="comment">/* Initialized local variable  */</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  resetcount = SPI_DEFAULT_TIMEOUT * (SystemCoreClock / 24U / 1000U);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  count = resetcount;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">/* Clear ERRIE interrupt to avoid error interrupts generation during Abort procedure */</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_ERRIE);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">/* Disable TXEIE, RXNEIE and ERRIE(mode fault event, overrun error, TI frame error) interrupts */</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXEIE))</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#gaa60285bfbb9d0fc6820be0a9b5b0dd79">SPI_AbortTx_ISR</a>;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="comment">/* Wait HAL_SPI_STATE_ABORT state */</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="keywordflow">if</span> (count == 0U)</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      {</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      count--;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    }</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782">HAL_SPI_STATE_ABORT</a>);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="comment">/* Reset Timeout Counter */</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    count = resetcount;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXNEIE))</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#ga209ef1a70d869a1834101dc3ff971349">SPI_AbortRx_ISR</a>;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">/* Wait HAL_SPI_STATE_ABORT state */</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <span class="keywordflow">if</span> (count == 0U)</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      {</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      count--;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782">HAL_SPI_STATE_ABORT</a>);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="comment">/* Reset Timeout Counter */</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    count = resetcount;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="comment">/* Disable the SPI DMA Tx request if enabled */</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN))</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="comment">/* Abort the SPI DMA Tx Stream/Channel : use blocking DMA Abort API (no callback) */</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a> != NULL)</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <span class="comment">/* Set the SPI DMA Abort callback :</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">      will lead to call HAL_SPI_AbortCpltCallback() at end of DMA abort procedure */</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      <span class="comment">/* Abort DMA Tx Handle linked to SPI Peripheral */</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__DMA__Exported__Functions__Group2.html#ga001f9fb04328a7460f9ff16908ff987c">HAL_DMA_Abort</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <span class="comment">/* Disable Tx DMA Request */</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, (SPI_CR2_TXDMAEN));</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#ga27117ecaaa02d6f682450a96375f252f">SPI_EndRxTxTransaction</a>(hspi, SPI_DEFAULT_TIMEOUT, <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>()) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="comment">/* Disable SPI Peripheral */</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;      __HAL_SPI_DISABLE(hspi);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <span class="comment">/* Empty the FRLVL fifo */</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaff756a3321d647c7e96b7ce608cb0b36">SPI_WaitFifoStateUntilTimeout</a>(hspi, SPI_FLAG_FRLVL, SPI_FRLVL_EMPTY, SPI_DEFAULT_TIMEOUT, <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>()) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; </div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <span class="comment">/* Disable the SPI DMA Rx request if enabled */</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXDMAEN))</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">/* Abort the SPI DMA Rx Stream/Channel : use blocking DMA Abort API (no callback) */</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a> != NULL)</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="comment">/* Set the SPI DMA Abort callback :</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment">      will lead to call HAL_SPI_AbortCpltCallback() at end of DMA abort procedure */</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="comment">/* Abort DMA Rx Handle linked to SPI Peripheral */</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__DMA__Exported__Functions__Group2.html#ga001f9fb04328a7460f9ff16908ff987c">HAL_DMA_Abort</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="comment">/* Disable peripheral */</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      __HAL_SPI_DISABLE(hspi);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="comment">/* Control the BSY flag */</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_BSY, RESET, SPI_DEFAULT_TIMEOUT, <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>()) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="comment">/* Empty the FRLVL fifo */</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaff756a3321d647c7e96b7ce608cb0b36">SPI_WaitFifoStateUntilTimeout</a>(hspi, SPI_FLAG_FRLVL, SPI_FRLVL_EMPTY, SPI_DEFAULT_TIMEOUT, <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>()) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      }</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <span class="comment">/* Disable Rx DMA Request */</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, (SPI_CR2_RXDMAEN));</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    }</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="comment">/* Reset Tx and Rx transfer counters */</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = 0U;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = 0U;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;  <span class="comment">/* Check error during Abort procedure */</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> == HAL_SPI_ERROR_ABORT)</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  {</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="comment">/* return HAL_Error in case of error during Abort procedure */</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  }</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  {</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="comment">/* Reset errorCode */</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">/* Clear the Error flags in the SR register */</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  __HAL_SPI_CLEAR_OVRFLAG(hspi);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  __HAL_SPI_CLEAR_FREFLAG(hspi);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="comment">/* Restore hspi-&gt;state to ready */</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga75d7782876ed13b9f8aebfa8dbba5a1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75d7782876ed13b9f8aebfa8dbba5a1c">&#9670;&nbsp;</a></span>HAL_SPI_Abort_IT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Abort_IT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort ongoing transfer (Interrupt mode). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>SPI handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This procedure could be used for aborting any ongoing transfer (Tx and Rx), started in Interrupt or DMA mode. This procedure performs following operations :<ul>
<li>Disable SPI Interrupts (depending of transfer direction)</li>
<li>Disable the DMA transfer in the peripheral register (if enabled)</li>
<li>Abort DMA transfer by calling HAL_DMA_Abort_IT (in case of transfer in DMA mode)</li>
<li>Set handle State to READY</li>
<li>At abort completion, call user abort complete callback </li>
</ul>
</dd>
<dd>
This procedure is executed in Interrupt mode, meaning that abort procedure could be considered as completed only when user abort complete callback is executed (not when exiting function). </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02407">2407</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;{</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  HAL_StatusTypeDef errorcode;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  uint32_t abortcplt ;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  __IO uint32_t count, resetcount;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <span class="comment">/* Initialized local variable  */</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  abortcplt = 1U;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  resetcount = SPI_DEFAULT_TIMEOUT * (SystemCoreClock / 24U / 1000U);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  count = resetcount;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; </div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="comment">/* Clear ERRIE interrupt to avoid error interrupts generation during Abort procedure */</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_ERRIE);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="comment">/* Change Rx and Tx Irq Handler to Disable TXEIE, RXNEIE and ERRIE interrupts */</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXEIE))</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#gaa60285bfbb9d0fc6820be0a9b5b0dd79">SPI_AbortTx_ISR</a>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="comment">/* Wait HAL_SPI_STATE_ABORT state */</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    {</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="keywordflow">if</span> (count == 0U)</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      }</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      count--;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    }</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782">HAL_SPI_STATE_ABORT</a>);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="comment">/* Reset Timeout Counter */</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    count = resetcount;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;  }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXNEIE))</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#ga209ef1a70d869a1834101dc3ff971349">SPI_AbortRx_ISR</a>;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">/* Wait HAL_SPI_STATE_ABORT state */</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    {</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordflow">if</span> (count == 0U)</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      {</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      count--;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782">HAL_SPI_STATE_ABORT</a>);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="comment">/* Reset Timeout Counter */</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    count = resetcount;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  }</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <span class="comment">/* If DMA Tx and/or DMA Rx Handles are associated to SPI Handle, DMA Abort complete callbacks should be initialised</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">     before any call to DMA Abort functions */</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <span class="comment">/* DMA Tx Handle is valid */</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a> != NULL)</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="comment">/* Set DMA Abort Complete callback if UART DMA Tx request if enabled.</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">       Otherwise, set it to NULL */</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN))</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    {</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gae75a58df1c60d212df0b77a2c18c0003">SPI_DMATxAbortCallback</a>;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  }</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  <span class="comment">/* DMA Rx Handle is valid */</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a> != NULL)</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="comment">/* Set DMA Abort Complete callback if UART DMA Rx request if enabled.</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">       Otherwise, set it to NULL */</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXDMAEN))</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gae911d05bb409c6177a772d408ec1ab36">SPI_DMARxAbortCallback</a>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    }</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="comment">/* Disable the SPI DMA Tx request if enabled */</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN))</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="comment">/* Abort the SPI DMA Tx Stream/Channel */</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a> != NULL)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="comment">/* Abort DMA Tx Handle linked to SPI Peripheral */</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__DMA__Exported__Functions__Group2.html#ga6677d7e614747341a58ffd7a048fd390">HAL_DMA_Abort_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      }</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        abortcplt = 0U;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  }</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="comment">/* Disable the SPI DMA Rx request if enabled */</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="keywordflow">if</span> (HAL_IS_BIT_SET(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXDMAEN))</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="comment">/* Abort the SPI DMA Rx Stream/Channel */</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a> != NULL)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="comment">/* Abort DMA Rx Handle linked to SPI Peripheral */</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="group__DMA__Exported__Functions__Group2.html#ga6677d7e614747341a58ffd7a048fd390">HAL_DMA_Abort_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>) !=  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_ABORT;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        abortcplt = 0U;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  }</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="keywordflow">if</span> (abortcplt == 1U)</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="comment">/* Reset Tx and Rx transfer counters */</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = 0U;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = 0U;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="comment">/* Check error during Abort procedure */</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> == HAL_SPI_ERROR_ABORT)</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="comment">/* return HAL_Error in case of error during Abort procedure */</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    }</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    {</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;      <span class="comment">/* Reset errorCode */</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    }</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160; </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="comment">/* Clear the Error flags in the SR register */</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    __HAL_SPI_CLEAR_OVRFLAG(hspi);</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    __HAL_SPI_CLEAR_FREFLAG(hspi);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="comment">/* Restore hspi-&gt;State to Ready */</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="comment">/* As no DMA to be aborted, call directly user Abort complete callback */</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="preprocessor">#if (USE_HAL_SPI_REGISTER_CALLBACKS == 1U)</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a383178b03c80ede5782c6ef0a890446a">AbortCpltCallback</a>(hspi);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <a class="code" href="group__SPI__Exported__Functions__Group2.html#gaf72fd0e437ebae7dc854ea20a2322c80">HAL_SPI_AbortCpltCallback</a>(hspi);</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_HAL_SPI_REGISTER_CALLBACKS */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;  }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf72fd0e437ebae7dc854ea20a2322c80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf72fd0e437ebae7dc854ea20a2322c80">&#9670;&nbsp;</a></span>HAL_SPI_AbortCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_AbortCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPI Abort Complete callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>SPI handle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02869">2869</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;{</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; </div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">            the HAL_SPI_AbortCpltCallback can be implemented in the user file.</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga61e4a628d6918ec838736d65ae135031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61e4a628d6918ec838736d65ae135031">&#9670;&nbsp;</a></span>HAL_SPI_DMAPause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_DMAPause </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pause the DMA Transfer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for the specified SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02569">2569</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;{</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="comment">/* Disable the SPI DMA Tx &amp; Rx requests */</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN | SPI_CR2_RXDMAEN);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160; </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7fdd4b7aa5c6bd560a476c833f546d93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7fdd4b7aa5c6bd560a476c833f546d93">&#9670;&nbsp;</a></span>HAL_SPI_DMAResume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_DMAResume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume the DMA Transfer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for the specified SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02589">2589</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;{</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160; </div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  <span class="comment">/* Enable the SPI DMA Tx &amp; Rx requests */</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;  SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN | SPI_CR2_RXDMAEN);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7e01eb529af91fabc950180b927fa355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e01eb529af91fabc950180b927fa355">&#9670;&nbsp;</a></span>HAL_SPI_DMAStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_DMAStop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the DMA Transfer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for the specified SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02609">2609</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;{</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="comment">/* The Lock is not implemented on this API to allow the user application</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">     to call the HAL SPI API under callbacks HAL_SPI_TxCpltCallback() or HAL_SPI_RxCpltCallback() or HAL_SPI_TxRxCpltCallback():</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment">     when calling HAL_DMA_Abort() API the DMA TX/RX Transfer complete interrupt is generated</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">     and the correspond call back is executed HAL_SPI_TxCpltCallback() or HAL_SPI_RxCpltCallback() or HAL_SPI_TxRxCpltCallback()</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="comment">/* Abort the SPI DMA tx Stream/Channel  */</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a> != NULL)</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga001f9fb04328a7460f9ff16908ff987c">HAL_DMA_Abort</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>))</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    {</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    }</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  }</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  <span class="comment">/* Abort the SPI DMA rx Stream/Channel  */</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a> != NULL)</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  {</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga001f9fb04328a7460f9ff16908ff987c">HAL_DMA_Abort</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>))</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    {</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    }</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  }</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;  <span class="comment">/* Disable the SPI DMA Tx &amp; Rx requests */</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN | SPI_CR2_RXDMAEN);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaeb4c01bcfbd998bd56cad9e4253399de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb4c01bcfbd998bd56cad9e4253399de">&#9670;&nbsp;</a></span>HAL_SPI_ErrorCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_ErrorCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SPI error callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02851">2851</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;{</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">            the HAL_SPI_ErrorCallback should be implemented in the user file</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">/* NOTE : The ErrorCode parameter in the hspi handle is updated by the SPI processes</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">            and user can use HAL_SPI_GetError() API to check the latest error occurred</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf3da6e0a87468bc039b578c21329df47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf3da6e0a87468bc039b578c21329df47">&#9670;&nbsp;</a></span>HAL_SPI_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HAL_SPI_IRQHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle SPI interrupt request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for the specified SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02649">2649</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;{</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  uint32_t itsource = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  uint32_t itflag   = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;SR;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <span class="comment">/* SPI in mode Receiver ----------------------------------------------------*/</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <span class="keywordflow">if</span> ((SPI_CHECK_FLAG(itflag, SPI_FLAG_OVR) == RESET) &amp;&amp;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      (SPI_CHECK_FLAG(itflag, SPI_FLAG_RXNE) != RESET) &amp;&amp; (SPI_CHECK_IT_SOURCE(itsource, SPI_IT_RXNE) != RESET))</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>(hspi);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  }</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; </div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="comment">/* SPI in mode Transmitter -------------------------------------------------*/</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  <span class="keywordflow">if</span> ((SPI_CHECK_FLAG(itflag, SPI_FLAG_TXE) != RESET) &amp;&amp; (SPI_CHECK_IT_SOURCE(itsource, SPI_IT_TXE) != RESET))</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>(hspi);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  }</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160; </div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <span class="comment">/* SPI in Error Treatment --------------------------------------------------*/</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="keywordflow">if</span> (((SPI_CHECK_FLAG(itflag, SPI_FLAG_MODF) != RESET) || (SPI_CHECK_FLAG(itflag, SPI_FLAG_OVR) != RESET) || (SPI_CHECK_FLAG(itflag, SPI_FLAG_FRE) != RESET)) &amp;&amp; (SPI_CHECK_IT_SOURCE(itsource, SPI_IT_ERR) != RESET))</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="comment">/* SPI Overrun error interrupt occurred ----------------------------------*/</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="keywordflow">if</span> (SPI_CHECK_FLAG(itflag, SPI_FLAG_OVR) != RESET)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab">HAL_SPI_STATE_BUSY_TX</a>)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_OVR);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        __HAL_SPI_CLEAR_OVRFLAG(hspi);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      }</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        __HAL_SPI_CLEAR_OVRFLAG(hspi);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    }</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160; </div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="comment">/* SPI Mode Fault error interrupt occurred -------------------------------*/</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">if</span> (SPI_CHECK_FLAG(itflag, SPI_FLAG_MODF) != RESET)</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_MODF);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      __HAL_SPI_CLEAR_MODFFLAG(hspi);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="comment">/* SPI Frame error interrupt occurred ------------------------------------*/</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">if</span> (SPI_CHECK_FLAG(itflag, SPI_FLAG_FRE) != RESET)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_FRE);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      __HAL_SPI_CLEAR_FREFLAG(hspi);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> != HAL_SPI_ERROR_NONE)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    {</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <span class="comment">/* Disable all interrupts */</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      __HAL_SPI_DISABLE_IT(hspi, SPI_IT_RXNE | SPI_IT_TXE | SPI_IT_ERR);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <span class="comment">/* Disable the SPI DMA requests if enabled */</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <span class="keywordflow">if</span> ((HAL_IS_BIT_SET(itsource, SPI_CR2_TXDMAEN)) || (HAL_IS_BIT_SET(itsource, SPI_CR2_RXDMAEN)))</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, (SPI_CR2_TXDMAEN | SPI_CR2_RXDMAEN));</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="comment">/* Abort the SPI DMA Rx channel */</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a> != NULL)</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        {</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;          <span class="comment">/* Set the SPI DMA Abort callback :</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">          will lead to call HAL_SPI_ErrorCallback() at end of DMA abort procedure */</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gab876e62eb52d15157fc0198109299ecb">SPI_DMAAbortOnError</a>;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga6677d7e614747341a58ffd7a048fd390">HAL_DMA_Abort_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>))</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;          {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;          }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        <span class="comment">/* Abort the SPI DMA Tx channel */</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a> != NULL)</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;          <span class="comment">/* Set the SPI DMA Abort callback :</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment">          will lead to call HAL_SPI_ErrorCallback() at end of DMA abort procedure */</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gab876e62eb52d15157fc0198109299ecb">SPI_DMAAbortOnError</a>;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga6677d7e614747341a58ffd7a048fd390">HAL_DMA_Abort_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>))</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;          {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_ABORT);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;          }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      {</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="comment">/* Call user error callback */</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="preprocessor">#if (USE_HAL_SPI_REGISTER_CALLBACKS == 1U)</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ac4bbea2bc6eb89764844679a544c519d">ErrorCallback</a>(hspi);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <a class="code" href="group__SPI__Exported__Functions__Group2.html#gaeb4c01bcfbd998bd56cad9e4253399de">HAL_SPI_ErrorCallback</a>(hspi);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_HAL_SPI_REGISTER_CALLBACKS */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      }</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    }</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;  }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gafdf43dbe4e5ef225bed6650b6e8c6313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdf43dbe4e5ef225bed6650b6e8c6313">&#9670;&nbsp;</a></span>HAL_SPI_Receive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Receive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>Timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive an amount of data in blocking mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be received </td></tr>
    <tr><td class="paramname">Timeout</td><td>Timeout duration </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l00972">972</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;{</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  uint32_t tickstart;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_MASTER) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES))</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">/* Call transmit-receive function to send Dummy data on Tx line and generate clock on CLK line */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SPI__Exported__Functions__Group2.html#ga7c3106fe01493a33b08e5c617f45aeb1">HAL_SPI_TransmitReceive</a>(hspi, pData, pData, Size, Timeout);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">/* Init tickstart for timeout management*/</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  tickstart = <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>();</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="comment">/*Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)NULL;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = 0U;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = 0U;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">/* this is done to handle the CRCNEXT before the latest data */</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>--;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">/* Set the Rx Fifo threshold */</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 8bit */</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">/* Configure communication direction: 1Line */</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    SPI_1LINE_RX(hspi);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="comment">/* Receive data in 8 Bit mode */</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &lt;= SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="comment">/* Transfer loop */</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">/* Check the RXNE flag */</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_RXNE))</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="comment">/* read the received data */</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        (* (uint8_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = *(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a> += <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>--;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="comment">/* Timeout management */</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">if</span> ((((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; (Timeout != HAL_MAX_DELAY)) || (Timeout == 0U))</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">/* Transfer loop */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="comment">/* Check the RXNE flag */</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_RXNE))</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = (uint16_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>--;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">/* Timeout management */</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">if</span> ((((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; (Timeout != HAL_MAX_DELAY)) || (Timeout == 0U))</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">/* Handle the CRC Transmission */</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">/* freeze the CRC before the latest data */</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_CRCNEXT);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">/* Read the latest data */</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_RXNE, SET, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="comment">/* the latest data has not been received */</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">/* Receive last data in 16 Bit mode */</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = (uint16_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">/* Receive last data in 8 Bit mode */</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      (*(uint8_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = *(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="comment">/* Wait the CRC data */</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_RXNE, SET, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="comment">/* Read CRC to Flush DR and RXNE flag */</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> == SPI_DATASIZE_16BIT)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="comment">/* Read 16bit CRC */</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      READ_REG(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="comment">/* Read 8bit CRC */</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      READ_REG(*(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> == SPI_DATASIZE_8BIT) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ade3815f539adcdeba866ab26a5f59c99">CRCLength</a> == SPI_CRC_LENGTH_16BIT))</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_RXNE, SET, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="comment">/* Error on the CRC reception */</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="comment">/* Read 8bit CRC again in case of 16bit CRC in 8bit Data mode */</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        READ_REG(*(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">/* Check the end of the transaction */</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gab9d90dd02f6ca501885023df5d6ed4ba">SPI_EndRxTransaction</a>(hspi, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_FLAG;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">/* Check if CRC error occurred */</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_CRCERR))</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    __HAL_SPI_CLEAR_CRCERRFLAG(hspi);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> != HAL_SPI_ERROR_NONE)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;error :</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga626bb2ec54e7b6ff9bd5d807ae6e6e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga626bb2ec54e7b6ff9bd5d807ae6e6e24">&#9670;&nbsp;</a></span>HAL_SPI_Receive_DMA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Receive_DMA </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive an amount of data in non-blocking mode with DMA. </p>
<dl class="section note"><dt>Note</dt><dd>In case of MASTER mode and SPI_DIRECTION_2LINES direction, hdmatx shall be defined. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When the CRC feature is enabled the pData Length must be Size + 1. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01914">1914</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;{</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="comment">/* Check rx dma handle */</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DMA_HANDLE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>));</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_MASTER))</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">/* Check tx dma handle */</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DMA_HANDLE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>));</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; </div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="comment">/* Call transmit-receive function to send Dummy data on Tx line and generate clock on CLK line */</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SPI__Exported__Functions__Group2.html#ga228553c64b10b8dade9fee525a8a489d">HAL_SPI_TransmitReceive_DMA</a>(hspi, pData, pData, Size);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="comment">/*Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = 0U;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = 0U;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  <span class="comment">/* Configure communication direction : 1Line */</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    SPI_1LINE_RX(hspi);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  }</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMARX);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 8bit */</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a3792cb34cedb0e2ab204e41b53ef75ad">Init</a>.MemDataAlignment == DMA_MDATAALIGN_HALFWORD)</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <span class="comment">/* Set RX Fifo threshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &amp; 0x1U) == 0x0U)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMARX);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt;&gt; 1U;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMARX);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt;&gt; 1U) + 1U;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;  }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="comment">/* Set the SPI RxDMA Half transfer complete callback */</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">XferHalfCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#ga78ebd9f55a7d966308bae704a4326510">SPI_DMAHalfReceiveCplt</a>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="comment">/* Set the SPI Rx DMA transfer complete callback */</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">XferCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gaf28f345edf16d2c3ed908a0cc8b9fdfa">SPI_DMAReceiveCplt</a>;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">/* Set the DMA error callback */</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5905bba1de7dc9d803a50dfb44d0a9e8">XferErrorCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gaad48e61b3c8df5c985ee474f5e3947e8">SPI_DMAError</a>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="comment">/* Set the DMA AbortCpltCallback */</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="comment">/* Enable the Rx DMA Stream/Channel  */</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga7eddc0931ac8a3d77b23d6d5e68407c7">HAL_DMA_Start_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>, (uint32_t)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR, (uint32_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>, hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>))</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">/* Update SPI error code */</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  }</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="comment">/* Enable the SPI Error Interrupt Bit */</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_ERR));</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="comment">/* Enable Rx DMA Request */</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXDMAEN);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;error:</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaaae0af2e2db7e7549b52b020a18f6168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaae0af2e2db7e7549b52b020a18f6168">&#9670;&nbsp;</a></span>HAL_SPI_Receive_IT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Receive_IT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive an amount of data in non-blocking mode with Interrupt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01578">1578</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;{</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_MASTER))</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">/* Call transmit-receive function to send Dummy data on Tx line and generate clock on CLK line */</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__SPI__Exported__Functions__Group2.html#ga518c43d8323499451e7f4782a9dc6e32">HAL_SPI_TransmitReceive_IT</a>(hspi, pData, pData, Size);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">/* Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)NULL;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = 0U;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = 0U;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">/* Check the data size to adapt Rx threshold and the set the function for IT treatment */</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 16 bit */</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#ga4a855158eb976bf81d4afd2fec94dca2">SPI_RxISR_16BIT</a>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 8 bit */</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#gabd2c3ffa402d32d49bc0683d39315eec">SPI_RxISR_8BIT</a>;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">/* Configure communication direction : 1Line */</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    SPI_1LINE_RX(hspi);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 1U;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &lt;= SPI_DATASIZE_8BIT) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ade3815f539adcdeba866ab26a5f59c99">CRCLength</a> == SPI_CRC_LENGTH_16BIT))</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 2U;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 0U;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="comment">/* Enable TXE and ERR interrupt */</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_RXNE | SPI_IT_ERR));</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="comment">/* Note : The SPI must be enabled after unlocking current process</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">            to avoid the risk of SPI interrupt handle execution before current</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">            process unlock */</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;error :</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga588e410e39147f920166b77220691c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga588e410e39147f920166b77220691c5a">&#9670;&nbsp;</a></span>HAL_SPI_RxCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_RxCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rx Transfer completed callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02771">2771</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;{</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160; </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">            the HAL_SPI_RxCpltCallback should be implemented in the user file</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf3b631cebfadace006e5ea8e5352743a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf3b631cebfadace006e5ea8e5352743a">&#9670;&nbsp;</a></span>HAL_SPI_RxHalfCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_RxHalfCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rx Half Transfer completed callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02819">2819</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;{</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">            the HAL_SPI_RxHalfCpltCallback() should be implemented in the user file</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga02ec86e05d0702387c221f90b6f041a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02ec86e05d0702387c221f90b6f041a2">&#9670;&nbsp;</a></span>HAL_SPI_Transmit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Transmit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>Timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit an amount of data in blocking mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
    <tr><td class="paramname">Timeout</td><td>Timeout duration </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l00789">789</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;{</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  uint32_t tickstart;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  uint16_t initial_TxXferCount;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES_OR_1LINE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">/* Init tickstart for timeout management*/</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  tickstart = <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>();</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  initial_TxXferCount = Size;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab">HAL_SPI_STATE_BUSY_TX</a>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">/*Init field not used in handle to zero */</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)NULL;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = 0U;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = 0U;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">/* Configure communication direction : 1Line */</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    SPI_1LINE_TX(hspi);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">/* Transmit data in 16 Bit mode */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_SLAVE) || (initial_TxXferCount == 0x01U))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">/* Transmit data in 16 Bit mode */</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="comment">/* Wait until TXE flag is set to send data */</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_TXE))</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">/* Timeout management */</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> ((((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; (Timeout != HAL_MAX_DELAY)) || (Timeout == 0U))</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">/* Transmit data in 8 Bit mode */</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_SLAVE) || (initial_TxXferCount == 0x01U))</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 1U)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment">/* write on the data register in packing mode */</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> -= 2U;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        *((__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR) = (*hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> ++;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">while</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">/* Wait until TXE flag is set to send data */</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_TXE))</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 1U)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          <span class="comment">/* write on the data register in packing mode */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> -= 2U;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          *((__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR) = (*hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>++;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="comment">/* Timeout management */</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">if</span> ((((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; (Timeout != HAL_MAX_DELAY)) || (Timeout == 0U))</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">/* Enable CRC Transmission */</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_CRCNEXT);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">/* Check the end of the transaction */</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#ga27117ecaaa02d6f682450a96375f252f">SPI_EndRxTxTransaction</a>(hspi, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_FLAG;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">/* Clear overrun flag in 2 Lines communication mode because received is not read */</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    __HAL_SPI_CLEAR_OVRFLAG(hspi);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> != HAL_SPI_ERROR_NONE)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;error:</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6aebe304396c3e18b55f926dae0dadcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6aebe304396c3e18b55f926dae0dadcb">&#9670;&nbsp;</a></span>HAL_SPI_Transmit_DMA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Transmit_DMA </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit an amount of data in non-blocking mode with DMA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01792">1792</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;{</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="comment">/* Check tx dma handle */</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DMA_HANDLE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>));</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES_OR_1LINE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab">HAL_SPI_STATE_BUSY_TX</a>;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="comment">/* Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)NULL;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = 0U;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = 0U;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">/* Configure communication direction : 1Line */</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    SPI_1LINE_TX(hspi);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; </div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="comment">/* Set the SPI TxDMA Half transfer complete callback */</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">XferHalfCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#ga73b6a4c1fca7e5935a256c4bc3258c6d">SPI_DMAHalfTransmitCplt</a>;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="comment">/* Set the SPI TxDMA transfer complete callback */</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">XferCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#ga59e2fa8b8f7ad87289bf02ae2ba5b8cb">SPI_DMATransmitCplt</a>;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="comment">/* Set the DMA error callback */</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5905bba1de7dc9d803a50dfb44d0a9e8">XferErrorCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gaad48e61b3c8df5c985ee474f5e3947e8">SPI_DMAError</a>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="comment">/* Set the DMA AbortCpltCallback */</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <span class="comment">/* Packing mode is enabled only if the DMA setting is HALWORD */</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &lt;= SPI_DATASIZE_8BIT) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a3792cb34cedb0e2ab204e41b53ef75ad">Init</a>.MemDataAlignment == DMA_MDATAALIGN_HALFWORD))</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;  {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">/* Check the even/odd of the data size + crc if enabled */</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &amp; 0x1U) == 0U)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt;&gt; 1U);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt;&gt; 1U) + 1U;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="comment">/* Enable the Tx DMA Stream/Channel */</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga7eddc0931ac8a3d77b23d6d5e68407c7">HAL_DMA_Start_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>, (uint32_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>, (uint32_t)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR, hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>))</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="comment">/* Update SPI error code */</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;  }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="comment">/* Enable the SPI Error Interrupt Bit */</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_ERR));</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="comment">/* Enable Tx DMA Request */</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;error :</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gafbb309aa738bb3296934fb1a39ffbf40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafbb309aa738bb3296934fb1a39ffbf40">&#9670;&nbsp;</a></span>HAL_SPI_Transmit_IT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_Transmit_IT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit an amount of data in non-blocking mode with Interrupt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pData</td><td>pointer to data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01495">1495</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;{</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES_OR_1LINE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordflow">if</span> ((pData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>       = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab">HAL_SPI_STATE_BUSY_TX</a>;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pData;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="comment">/* Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)NULL;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = 0U;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = 0U;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="comment">/* Set the function for IT treatment */</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#ga36058667ccad4c193ee853158ce046dd">SPI_TxISR_16BIT</a>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a> = <a class="code" href="group__SPI__Private__Functions.html#ga61e8784d9e16109e064e2c28617e9af9">SPI_TxISR_8BIT</a>;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="comment">/* Configure communication direction : 1Line */</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_1LINE)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    SPI_1LINE_TX(hspi);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="comment">/* Enable TXE and ERR interrupt */</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_TXE | SPI_IT_ERR));</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;error :</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga7c3106fe01493a33b08e5c617f45aeb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c3106fe01493a33b08e5c617f45aeb1">&#9670;&nbsp;</a></span>HAL_SPI_TransmitReceive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_TransmitReceive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pTxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pRxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>Timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit and Receive an amount of data in blocking mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pTxData</td><td>pointer to transmission data buffer </td></tr>
    <tr><td class="paramname">pRxData</td><td>pointer to reception data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent and received </td></tr>
    <tr><td class="paramname">Timeout</td><td>Timeout duration </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01197">1197</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;{</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  uint16_t             initial_TxXferCount;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  uint16_t             initial_RxXferCount;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  uint32_t             tmp_mode;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <a class="code" href="group__SPI__Exported__Types.html#ga8891cb64e76198a860172d94c638c9b4">HAL_SPI_StateTypeDef</a> tmp_state;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  uint32_t             tickstart;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  uint32_t             spi_cr1;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  uint32_t             spi_cr2;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="comment">/* Variable used to alternate Rx and Tx during transfer */</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  uint32_t             txallowed = 1U;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  HAL_StatusTypeDef    errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">/* Process Locked */</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="comment">/* Init tickstart for timeout management*/</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  tickstart = <a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="comment">/* Init temporary variables */</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  tmp_state           = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  tmp_mode            = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  initial_TxXferCount = Size;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  initial_RxXferCount = Size;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  spi_cr1             = READ_REG(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  spi_cr2             = READ_REG(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  <span class="keywordflow">if</span> (!((tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>) || \</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        ((tmp_mode == SPI_MODE_MASTER) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES) &amp;&amp; (tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>))))</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">if</span> ((pTxData == NULL) || (pRxData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">/* Don&#39;t overwrite in case of HAL_SPI_STATE_BUSY_RX */</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a9dae2883ae3e43ca28afc9453a14c938">HAL_SPI_STATE_BUSY_TX_RX</a>;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pRxData;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pTxData;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">/*Init field not used in handle to zero */</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="comment">/* Set the Rx Fifo threshold */</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT) || (initial_RxXferCount &gt; 1U))</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">/* Set fiforxthreshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">/* Set fiforxthreshold according the reception data length: 8bit */</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">/* Transmit and Receive data in 16 Bit mode */</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_SLAVE) || (initial_TxXferCount == 0x01U))</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">while</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U) || (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U))</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="comment">/* Check TXE flag */</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keywordflow">if</span> ((__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_TXE)) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U) &amp;&amp; (txallowed == 1U))</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="comment">/* Next Data is a reception (Rx). Tx not allowed */</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        txallowed = 0U;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="comment">/* Enable CRC Transmission */</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> == 0U) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE))</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;          <span class="comment">/* Set NSS Soft to received correctly the CRC on slave mode with NSS pulse activated */</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          <span class="keywordflow">if</span> ((READ_BIT(spi_cr1, SPI_CR1_MSTR) == 0U) &amp;&amp; (READ_BIT(spi_cr2, SPI_CR2_NSSP) == SPI_CR2_NSSP))</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;          {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_SSM);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_CRCNEXT);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <span class="comment">/* Check RXNE flag */</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">if</span> ((__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_RXNE)) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U))</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = (uint16_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>--;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="comment">/* Next Data is a Transmission (Tx). Tx is allowed */</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        txallowed = 1U;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">if</span> (((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; (Timeout != HAL_MAX_DELAY))</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="comment">/* Transmit and Receive data in 8 Bit mode */</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a> == SPI_MODE_SLAVE) || (initial_TxXferCount == 0x01U))</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 1U)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> -= 2U;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        *(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = (*hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>++;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">while</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U) || (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U))</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="comment">/* Check TXE flag */</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">if</span> ((__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_TXE)) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 0U) &amp;&amp; (txallowed == 1U))</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt; 1U)</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        {</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> -= 2U;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;          *(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR = (*hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>++;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>--;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="comment">/* Next Data is a reception (Rx). Tx not allowed */</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        txallowed = 0U;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="comment">/* Enable CRC Transmission */</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> == 0U) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE))</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="comment">/* Set NSS Soft to received correctly the CRC on slave mode with NSS pulse activated */</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="keywordflow">if</span> ((READ_BIT(spi_cr1, SPI_CR1_MSTR) == 0U) &amp;&amp; (READ_BIT(spi_cr2, SPI_CR2_NSSP) == SPI_CR2_NSSP))</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_SSM);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1, SPI_CR1_CRCNEXT);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="comment">/* Wait until RXNE flag is reset */</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordflow">if</span> ((__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_RXNE)) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 0U))</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt; 1U)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          *((uint16_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = (uint16_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a> += <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> -= 2U;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;          <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &lt;= 1U)</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <span class="comment">/* Set RX Fifo threshold before to switch on 8 bit data size */</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          (*(uint8_t *)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>) = *(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>++;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>--;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="comment">/* Next Data is a Transmission (Tx). Tx is allowed */</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        txallowed = 1U;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      <span class="keywordflow">if</span> ((((<a class="code" href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a>() - tickstart) &gt;=  Timeout) &amp;&amp; ((Timeout != HAL_MAX_DELAY))) || (Timeout == 0U))</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="comment">/* Read CRC from DR to close CRC calculation process */</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">/* Wait until TXE flag */</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_RXNE, SET, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="comment">/* Error on the CRC reception */</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">/* Read CRC */</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> == SPI_DATASIZE_16BIT)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="comment">/* Read 16bit CRC */</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      READ_REG(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      <span class="comment">/* Read 8bit CRC */</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      READ_REG(*(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ade3815f539adcdeba866ab26a5f59c99">CRCLength</a> == SPI_CRC_LENGTH_16BIT)</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a>(hspi, SPI_FLAG_RXNE, SET, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          <span class="comment">/* Error on the CRC reception */</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          errorcode = HAL_TIMEOUT;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="comment">/* Read 8bit CRC again in case of 16bit CRC in 8bit Data mode */</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        READ_REG(*(__IO uint8_t *)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">/* Check if CRC error occurred */</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (__HAL_SPI_GET_FLAG(hspi, SPI_FLAG_CRCERR))</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_CRC);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">/* Clear CRC Flag */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    __HAL_SPI_CLEAR_CRCERRFLAG(hspi);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="comment">/* Check the end of the transaction */</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__SPI__Private__Functions.html#ga27117ecaaa02d6f682450a96375f252f">SPI_EndRxTxTransaction</a>(hspi, Timeout, tickstart) != <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a> = HAL_SPI_ERROR_FLAG;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;error :</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga228553c64b10b8dade9fee525a8a489d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga228553c64b10b8dade9fee525a8a489d">&#9670;&nbsp;</a></span>HAL_SPI_TransmitReceive_DMA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_TransmitReceive_DMA </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pTxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pRxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit and Receive an amount of data in non-blocking mode with DMA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pTxData</td><td>pointer to transmission data buffer </td></tr>
    <tr><td class="paramname">pRxData</td><td>pointer to reception data buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When the CRC feature is enabled the pRxData Length must be Size + 1 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Size</td><td>amount of data to be sent </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02056">2056</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;{</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  uint32_t             tmp_mode;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <a class="code" href="group__SPI__Exported__Types.html#ga8891cb64e76198a860172d94c638c9b4">HAL_SPI_StateTypeDef</a> tmp_state;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  HAL_StatusTypeDef errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">/* Check rx &amp; tx dma handles */</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DMA_HANDLE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>));</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DMA_HANDLE(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>));</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;  <span class="comment">/* Process locked */</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="comment">/* Init temporary variables */</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  tmp_state           = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;  tmp_mode            = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <span class="keywordflow">if</span> (!((tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>) ||</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        ((tmp_mode == SPI_MODE_MASTER) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES) &amp;&amp; (tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>))))</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;  {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  <span class="keywordflow">if</span> ((pTxData == NULL) || (pRxData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;  }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  <span class="comment">/* Don&#39;t overwrite in case of HAL_SPI_STATE_BUSY_RX */</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a9dae2883ae3e43ca28afc9453a14c938">HAL_SPI_STATE_BUSY_TX_RX</a>;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pTxData;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pRxData;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="comment">/* Init field not used in handle to zero */</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>       = NULL;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>       = NULL;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="comment">/* Reset the threshold bit */</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX | SPI_CR2_LDMARX);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160; </div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="comment">/* The packing mode management is enabled by the DMA settings according the spi data size */</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="comment">/* Set fiforxthreshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 8bit */</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a3792cb34cedb0e2ab204e41b53ef75ad">Init</a>.MemDataAlignment == DMA_MDATAALIGN_HALFWORD)</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a> &amp; 0x1U) == 0x0U)</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      {</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt;&gt; 1U;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMATX);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> &gt;&gt; 1U) + 1U;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    }</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a3792cb34cedb0e2ab204e41b53ef75ad">Init</a>.MemDataAlignment == DMA_MDATAALIGN_HALFWORD)</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <span class="comment">/* Set RX Fifo threshold according the reception data length: 16bit */</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; </div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &amp; 0x1U) == 0x0U)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMARX);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt;&gt; 1U;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_LDMARX);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> &gt;&gt; 1U) + 1U;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="comment">/* Check if we are in Rx only or in Rx/Tx Mode and configure the DMA transfer complete callback */</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">/* Set the SPI Rx DMA Half transfer complete callback */</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">XferHalfCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#ga78ebd9f55a7d966308bae704a4326510">SPI_DMAHalfReceiveCplt</a>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">XferCpltCallback</a>     = <a class="code" href="group__SPI__Private__Functions.html#gaf28f345edf16d2c3ed908a0cc8b9fdfa">SPI_DMAReceiveCplt</a>;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  {</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">/* Set the SPI Tx/Rx DMA Half transfer complete callback */</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">XferHalfCpltCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#ga07d334c19b44ac0ce9c71e92d0bdeb9b">SPI_DMAHalfTransmitReceiveCplt</a>;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">XferCpltCallback</a>     = <a class="code" href="group__SPI__Private__Functions.html#ga9c5d8f65ef633ac4ed722af45852e54d">SPI_DMATransmitReceiveCplt</a>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  <span class="comment">/* Set the DMA error callback */</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5905bba1de7dc9d803a50dfb44d0a9e8">XferErrorCallback</a> = <a class="code" href="group__SPI__Private__Functions.html#gaad48e61b3c8df5c985ee474f5e3947e8">SPI_DMAError</a>;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="comment">/* Set the DMA AbortCpltCallback */</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a> = NULL;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; </div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="comment">/* Enable the Rx DMA Stream/Channel  */</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga7eddc0931ac8a3d77b23d6d5e68407c7">HAL_DMA_Start_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">hdmarx</a>, (uint32_t)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR, (uint32_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>, hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a>))</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">/* Update SPI error code */</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="comment">/* Enable Rx DMA Request */</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_RXDMAEN);</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="comment">/* Set the SPI Tx DMA transfer complete callback as NULL because the communication closing</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">  is performed in DMA reception complete callback  */</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">XferHalfCpltCallback</a> = NULL;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">XferCpltCallback</a>     = NULL;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5905bba1de7dc9d803a50dfb44d0a9e8">XferErrorCallback</a>    = NULL;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>-&gt;<a class="code" href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">XferAbortCallback</a>    = NULL;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="comment">/* Enable the Tx DMA Stream/Channel  */</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a> != <a class="code" href="group__DMA__Exported__Functions__Group2.html#ga7eddc0931ac8a3d77b23d6d5e68407c7">HAL_DMA_Start_IT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">hdmatx</a>, (uint32_t)hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>, (uint32_t)&amp;hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;DR, hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a>))</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="comment">/* Update SPI error code */</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>, HAL_SPI_ERROR_DMA);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">/* Enable the SPI Error Interrupt Bit */</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_ERR));</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="comment">/* Enable Tx DMA Request */</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_CR2_TXDMAEN);</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;error :</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga518c43d8323499451e7f4782a9dc6e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga518c43d8323499451e7f4782a9dc6e32">&#9670;&nbsp;</a></span>HAL_SPI_TransmitReceive_IT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HAL_StatusTypeDef HAL_SPI_TransmitReceive_IT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pTxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pRxData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>Size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmit and Receive an amount of data in non-blocking mode with Interrupt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
    <tr><td class="paramname">pTxData</td><td>pointer to transmission data buffer </td></tr>
    <tr><td class="paramname">pRxData</td><td>pointer to reception data buffer </td></tr>
    <tr><td class="paramname">Size</td><td>amount of data to be sent and received </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL</td><td>status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l01683">1683</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;{</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  uint32_t             tmp_mode;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  <a class="code" href="group__SPI__Exported__Types.html#ga8891cb64e76198a860172d94c638c9b4">HAL_SPI_StateTypeDef</a> tmp_state;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  HAL_StatusTypeDef    errorcode = <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="comment">/* Check Direction parameter */</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a>(IS_SPI_DIRECTION_2LINES(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a>));</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="comment">/* Process locked */</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a>(hspi);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="comment">/* Init temporary variables */</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  tmp_state           = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  tmp_mode            = hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">Mode</a>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">if</span> (!((tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a>) || \</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        ((tmp_mode == SPI_MODE_MASTER) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">Direction</a> == SPI_DIRECTION_2LINES) &amp;&amp; (tmp_state == <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>))))</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    errorcode = HAL_BUSY;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">if</span> ((pTxData == NULL) || (pRxData == NULL) || (Size == 0U))</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    errorcode = HAL_ERROR;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  <span class="comment">/* Don&#39;t overwrite in case of HAL_SPI_STATE_BUSY_RX */</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> != <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a>)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">State</a> = <a class="code" href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a9dae2883ae3e43ca28afc9453a14c938">HAL_SPI_STATE_BUSY_TX_RX</a>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">/* Set the transaction information */</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">ErrorCode</a>   = HAL_SPI_ERROR_NONE;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">pTxBuffPtr</a>  = (uint8_t *)pTxData;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">TxXferSize</a>  = Size;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">TxXferCount</a> = Size;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">pRxBuffPtr</a>  = (uint8_t *)pRxData;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">RxXferSize</a>  = Size;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">RxXferCount</a> = Size;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">/* Set the function for IT treatment */</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>     = <a class="code" href="group__SPI__Private__Functions.html#ga77fa5dac63b08379f35895c7b385adee">SPI_2linesRxISR_16BIT</a>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>     = <a class="code" href="group__SPI__Private__Functions.html#ga4a1f3d4a85c87ed905ec45c42a98497c">SPI_2linesTxISR_16BIT</a>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">RxISR</a>     = <a class="code" href="group__SPI__Private__Functions.html#ga5e9b0e9bb7cca9482717d55ebee0a290">SPI_2linesRxISR_8BIT</a>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">TxISR</a>     = <a class="code" href="group__SPI__Private__Functions.html#ga2197d57a17bb597bf6360c9951c4efc8">SPI_2linesTxISR_8BIT</a>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="preprocessor">#if (USE_SPI_CRC != 0U)</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="comment">/* Reset CRC Calculation */</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordflow">if</span> (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">CRCCalculation</a> == SPI_CRCCALCULATION_ENABLE)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 1U;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &lt;= SPI_DATASIZE_8BIT) &amp;&amp; (hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#ade3815f539adcdeba866ab26a5f59c99">CRCLength</a> == SPI_CRC_LENGTH_16BIT))</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 2U;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    SPI_RESET_CRC(hspi);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">CRCSize</a> = 0U;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_SPI_CRC */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="comment">/* Check if packing mode is enabled and if there is more than 2 data to receive */</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">Init</a>.<a class="code" href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">DataSize</a> &gt; SPI_DATASIZE_8BIT) || (Size &gt;= 2U))</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 16 bit */</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a>(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">/* Set RX Fifo threshold according the reception data length: 8 bit */</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    SET_BIT(hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR2, SPI_RXFIFO_THRESHOLD);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">/* Enable TXE, RXNE and ERR interrupt */</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  __HAL_SPI_ENABLE_IT(hspi, (SPI_IT_TXE | SPI_IT_RXNE | SPI_IT_ERR));</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="comment">/* Check if the SPI is already enabled */</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">if</span> ((hspi-&gt;<a class="code" href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">Instance</a>-&gt;CR1 &amp; SPI_CR1_SPE) != SPI_CR1_SPE)</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  {</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">/* Enable SPI peripheral */</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    __HAL_SPI_ENABLE(hspi);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;error :</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">/* Process Unlocked */</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <a class="code" href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a>(hspi);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="keywordflow">return</span> errorcode;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaba27e527ac90813300e6033f639079ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba27e527ac90813300e6033f639079ef">&#9670;&nbsp;</a></span>HAL_SPI_TxCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_TxCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tx Transfer completed callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02755">2755</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;{</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160; </div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">            the HAL_SPI_TxCpltCallback should be implemented in the user file</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gae199977f796bd5d33fb59d3cd3aff6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae199977f796bd5d33fb59d3cd3aff6a3">&#9670;&nbsp;</a></span>HAL_SPI_TxHalfCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_TxHalfCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tx Half Transfer completed callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02803">2803</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;{</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160; </div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment">            the HAL_SPI_TxHalfCpltCallback should be implemented in the user file</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ga6b79c3829364ec69cd17622b0cdbc00f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6b79c3829364ec69cd17622b0cdbc00f">&#9670;&nbsp;</a></span>HAL_SPI_TxRxCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_TxRxCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tx and Rx Transfer completed callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02787">2787</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;{</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">            the HAL_SPI_TxRxCpltCallback should be implemented in the user file</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="gaf2ad9005465537b745e151e722df7c5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2ad9005465537b745e151e722df7c5b">&#9670;&nbsp;</a></span>HAL_SPI_TxRxHalfCpltCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__weak void HAL_SPI_TxRxHalfCpltCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SPI__Exported__Types.html#gab3bd115785297692c125528b7293566b">SPI_HandleTypeDef</a> *&#160;</td>
          <td class="paramname"><em>hspi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tx and Rx Half Transfer callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hspi</td><td>pointer to a SPI_HandleTypeDef structure that contains the configuration information for SPI module. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="stm32l4xx__hal__spi_8c_source.html#l02835">2835</a> of file <a class="el" href="stm32l4xx__hal__spi_8c_source.html">stm32l4xx_hal_spi.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;{</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  <span class="comment">/* Prevent unused argument(s) compilation warning */</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  UNUSED(hspi);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160; </div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  <span class="comment">/* NOTE : This function should not be modified, when the callback is needed,</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="comment">            the HAL_SPI_TxRxHalfCpltCallback() should be implemented in the user file</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__SPI__Exported__Types_html_a3472de9bd9247c1d97312aff7e58e385"><div class="ttname"><a href="group__SPI__Exported__Types.html#a3472de9bd9247c1d97312aff7e58e385">SPI_InitTypeDef::CRCCalculation</a></div><div class="ttdeci">uint32_t CRCCalculation</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00080">stm32l4xx_hal_spi.h:80</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gae911d05bb409c6177a772d408ec1ab36"><div class="ttname"><a href="group__SPI__Private__Functions.html#gae911d05bb409c6177a772d408ec1ab36">SPI_DMARxAbortCallback</a></div><div class="ttdeci">static void SPI_DMARxAbortCallback(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI Rx communication abort callback, when initiated by user (To be called at end of DMA Rx Abort ...</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03347">stm32l4xx_hal_spi.c:3347</a></div></div>
<div class="ttc" id="agroup__RTCEx__Exported__Functions__Group2_html_ga4734c37dd6682d79ce748b9bff126f66"><div class="ttname"><a href="group__RTCEx__Exported__Functions__Group2.html#ga4734c37dd6682d79ce748b9bff126f66">CLEAR_BIT</a></div><div class="ttdeci">CLEAR_BIT(hrtc-&gt;Instance-&gt;CR, RTC_CR_WUTE)</div></div>
<div class="ttc" id="agroup__SPI__Exported__Functions__Group2_html_gaeb4c01bcfbd998bd56cad9e4253399de"><div class="ttname"><a href="group__SPI__Exported__Functions__Group2.html#gaeb4c01bcfbd998bd56cad9e4253399de">HAL_SPI_ErrorCallback</a></div><div class="ttdeci">void HAL_SPI_ErrorCallback(SPI_HandleTypeDef *hspi)</div><div class="ttdoc">SPI error callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l02851">stm32l4xx_hal_spi.c:2851</a></div></div>
<div class="ttc" id="agroup__RTCEx__Exported__Functions__Group2_html_ga3feac430acb1b5e74ad139639f3af9ca"><div class="ttname"><a href="group__RTCEx__Exported__Functions__Group2.html#ga3feac430acb1b5e74ad139639f3af9ca">__HAL_UNLOCK</a></div><div class="ttdeci">__HAL_UNLOCK(hrtc)</div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga36058667ccad4c193ee853158ce046dd"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga36058667ccad4c193ee853158ce046dd">SPI_TxISR_16BIT</a></div><div class="ttdeci">static void SPI_TxISR_16BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Handle the data 16-bit transmit in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03757">stm32l4xx_hal_spi.c:3757</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ac4bbea2bc6eb89764844679a544c519d"><div class="ttname"><a href="group__SPI__Exported__Types.html#ac4bbea2bc6eb89764844679a544c519d">__SPI_HandleTypeDef::ErrorCallback</a></div><div class="ttdeci">void(* ErrorCallback)(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00157">stm32l4xx_hal_spi.h:157</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a599045b20d284f94e5a367a85cad9f39"><div class="ttname"><a href="group__SPI__Exported__Types.html#a599045b20d284f94e5a367a85cad9f39">__SPI_HandleTypeDef::RxISR</a></div><div class="ttdeci">void(* RxISR)(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00136">stm32l4xx_hal_spi.h:136</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gaff756a3321d647c7e96b7ce608cb0b36"><div class="ttname"><a href="group__SPI__Private__Functions.html#gaff756a3321d647c7e96b7ce608cb0b36">SPI_WaitFifoStateUntilTimeout</a></div><div class="ttdeci">static HAL_StatusTypeDef SPI_WaitFifoStateUntilTimeout(SPI_HandleTypeDef *hspi, uint32_t Fifo, uint32_t State, uint32_t Timeout, uint32_t Tickstart)</div><div class="ttdoc">Handle SPI FIFO Communication Timeout.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03839">stm32l4xx_hal_spi.c:3839</a></div></div>
<div class="ttc" id="astruct____DMA__HandleTypeDef_html_a5866f59e3a12760e559c4547ebf19d37"><div class="ttname"><a href="struct____DMA__HandleTypeDef.html#a5866f59e3a12760e559c4547ebf19d37">__DMA_HandleTypeDef::XferAbortCallback</a></div><div class="ttdeci">void(* XferAbortCallback)(struct __DMA_HandleTypeDef *hdma)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8h_source.html#l00131">stm32l4xx_hal_dma.h:131</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ab274a4c2de5e95145d45fe80a289f535"><div class="ttname"><a href="group__SPI__Exported__Types.html#ab274a4c2de5e95145d45fe80a289f535">__SPI_HandleTypeDef::RxXferSize</a></div><div class="ttdeci">uint16_t RxXferSize</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00130">stm32l4xx_hal_spi.h:130</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ab2497f2e3cfae59376db75da3bda7ffe"><div class="ttname"><a href="group__SPI__Exported__Types.html#ab2497f2e3cfae59376db75da3bda7ffe">__SPI_HandleTypeDef::ErrorCode</a></div><div class="ttdeci">__IO uint32_t ErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00148">stm32l4xx_hal_spi.h:148</a></div></div>
<div class="ttc" id="agroup__DMA__Exported__Functions__Group2_html_ga6677d7e614747341a58ffd7a048fd390"><div class="ttname"><a href="group__DMA__Exported__Functions__Group2.html#ga6677d7e614747341a58ffd7a048fd390">HAL_DMA_Abort_IT</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_DMA_Abort_IT(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">Aborts the DMA Transfer in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8c_source.html#l00608">stm32l4xx_hal_dma.c:608</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277"><div class="ttname"><a href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4afd7e00128aca1feaa099c2595ffb9277">HAL_SPI_STATE_BUSY_RX</a></div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00107">stm32l4xx_hal_spi.h:107</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga78ebd9f55a7d966308bae704a4326510"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga78ebd9f55a7d966308bae704a4326510">SPI_DMAHalfReceiveCplt</a></div><div class="ttdeci">static void SPI_DMAHalfReceiveCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI half receive process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03200">stm32l4xx_hal_spi.c:3200</a></div></div>
<div class="ttc" id="astruct____DMA__HandleTypeDef_html_a4f323d8234b3f5f454a639e9df3cba23"><div class="ttname"><a href="struct____DMA__HandleTypeDef.html#a4f323d8234b3f5f454a639e9df3cba23">__DMA_HandleTypeDef::XferCpltCallback</a></div><div class="ttdeci">void(* XferCpltCallback)(struct __DMA_HandleTypeDef *hdma)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8h_source.html#l00125">stm32l4xx_hal_dma.h:125</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a4b43d4d72f571b7d2162a2d171bb1312"><div class="ttname"><a href="group__SPI__Exported__Types.html#a4b43d4d72f571b7d2162a2d171bb1312">__SPI_HandleTypeDef::Init</a></div><div class="ttdeci">SPI_InitTypeDef Init</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00120">stm32l4xx_hal_spi.h:120</a></div></div>
<div class="ttc" id="astruct____DMA__HandleTypeDef_html_a3792cb34cedb0e2ab204e41b53ef75ad"><div class="ttname"><a href="struct____DMA__HandleTypeDef.html#a3792cb34cedb0e2ab204e41b53ef75ad">__DMA_HandleTypeDef::Init</a></div><div class="ttdeci">DMA_InitTypeDef Init</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8h_source.html#l00117">stm32l4xx_hal_dma.h:117</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_abef898bf323d7e9d693665f12b6f6239"><div class="ttname"><a href="group__SPI__Exported__Types.html#abef898bf323d7e9d693665f12b6f6239">__SPI_HandleTypeDef::CRCSize</a></div><div class="ttdeci">uint32_t CRCSize</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00134">stm32l4xx_hal_spi.h:134</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_aa311e9419f520aee2d2fa30668ce485c"><div class="ttname"><a href="group__SPI__Exported__Types.html#aa311e9419f520aee2d2fa30668ce485c">__SPI_HandleTypeDef::hdmatx</a></div><div class="ttdeci">DMA_HandleTypeDef * hdmatx</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00140">stm32l4xx_hal_spi.h:140</a></div></div>
<div class="ttc" id="agroup__HAL__Exported__Functions__Group2_html_gac9b3a85a73735ac840d0dcb59bc0fdd6"><div class="ttname"><a href="group__HAL__Exported__Functions__Group2.html#gac9b3a85a73735ac840d0dcb59bc0fdd6">HAL_GetTick</a></div><div class="ttdeci">uint32_t HAL_GetTick(void)</div><div class="ttdoc">Provide a tick value in millisecond.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal_8c_source.html#l00337">stm32l4xx_hal.c:337</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Functions__Group2_html_gaf72fd0e437ebae7dc854ea20a2322c80"><div class="ttname"><a href="group__SPI__Exported__Functions__Group2.html#gaf72fd0e437ebae7dc854ea20a2322c80">HAL_SPI_AbortCpltCallback</a></div><div class="ttdeci">void HAL_SPI_AbortCpltCallback(SPI_HandleTypeDef *hspi)</div><div class="ttdoc">SPI Abort Complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l02869">stm32l4xx_hal_spi.c:2869</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ae5c132f597c806d7a1fe316023b36867"><div class="ttname"><a href="group__SPI__Exported__Types.html#ae5c132f597c806d7a1fe316023b36867">SPI_InitTypeDef::Direction</a></div><div class="ttdeci">uint32_t Direction</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00052">stm32l4xx_hal_spi.h:52</a></div></div>
<div class="ttc" id="astruct____DMA__HandleTypeDef_html_a5905bba1de7dc9d803a50dfb44d0a9e8"><div class="ttname"><a href="struct____DMA__HandleTypeDef.html#a5905bba1de7dc9d803a50dfb44d0a9e8">__DMA_HandleTypeDef::XferErrorCallback</a></div><div class="ttdeci">void(* XferErrorCallback)(struct __DMA_HandleTypeDef *hdma)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8h_source.html#l00129">stm32l4xx_hal_dma.h:129</a></div></div>
<div class="ttc" id="astruct____DMA__HandleTypeDef_html_a2e343c6a9135222a8efb8ca5bb5dad8c"><div class="ttname"><a href="struct____DMA__HandleTypeDef.html#a2e343c6a9135222a8efb8ca5bb5dad8c">__DMA_HandleTypeDef::XferHalfCpltCallback</a></div><div class="ttdeci">void(* XferHalfCpltCallback)(struct __DMA_HandleTypeDef *hdma)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8h_source.html#l00127">stm32l4xx_hal_dma.h:127</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a24b7835dd877e1c4e55236303fa3387f"><div class="ttname"><a href="group__SPI__Exported__Types.html#a24b7835dd877e1c4e55236303fa3387f">SPI_InitTypeDef::DataSize</a></div><div class="ttdeci">uint32_t DataSize</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00055">stm32l4xx_hal_spi.h:55</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ade3815f539adcdeba866ab26a5f59c99"><div class="ttname"><a href="group__SPI__Exported__Types.html#ade3815f539adcdeba866ab26a5f59c99">SPI_InitTypeDef::CRCLength</a></div><div class="ttdeci">uint32_t CRCLength</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00086">stm32l4xx_hal_spi.h:86</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gaf28f345edf16d2c3ed908a0cc8b9fdfa"><div class="ttname"><a href="group__SPI__Private__Functions.html#gaf28f345edf16d2c3ed908a0cc8b9fdfa">SPI_DMAReceiveCplt</a></div><div class="ttdeci">static void SPI_DMAReceiveCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI receive process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l02998">stm32l4xx_hal_spi.c:2998</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782"><div class="ttname"><a href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a34f9231d040d752a034db85e3eb7f782">HAL_SPI_STATE_ABORT</a></div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00110">stm32l4xx_hal_spi.h:110</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga9c5d8f65ef633ac4ed722af45852e54d"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga9c5d8f65ef633ac4ed722af45852e54d">SPI_DMATransmitReceiveCplt</a></div><div class="ttdeci">static void SPI_DMATransmitReceiveCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI transmit receive process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03093">stm32l4xx_hal_spi.c:3093</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Functions__Group2_html_ga228553c64b10b8dade9fee525a8a489d"><div class="ttname"><a href="group__SPI__Exported__Functions__Group2.html#ga228553c64b10b8dade9fee525a8a489d">HAL_SPI_TransmitReceive_DMA</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_SPI_TransmitReceive_DMA(SPI_HandleTypeDef *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size)</div><div class="ttdoc">Transmit and Receive an amount of data in non-blocking mode with DMA.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l02056">stm32l4xx_hal_spi.c:2056</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gaa60285bfbb9d0fc6820be0a9b5b0dd79"><div class="ttname"><a href="group__SPI__Private__Functions.html#gaa60285bfbb9d0fc6820be0a9b5b0dd79">SPI_AbortTx_ISR</a></div><div class="ttdeci">static void SPI_AbortTx_ISR(SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Handle abort a Tx or Rx/Tx transaction.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l04191">stm32l4xx_hal_spi.c:4191</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gae75a58df1c60d212df0b77a2c18c0003"><div class="ttname"><a href="group__SPI__Private__Functions.html#gae75a58df1c60d212df0b77a2c18c0003">SPI_DMATxAbortCallback</a></div><div class="ttdeci">static void SPI_DMATxAbortCallback(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI Tx communication abort callback, when initiated by user (To be called at end of DMA Tx Abort ...</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03281">stm32l4xx_hal_spi.c:3281</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a0876a1b344524bbdbd984be1c3b07a10"><div class="ttname"><a href="group__SPI__Exported__Types.html#a0876a1b344524bbdbd984be1c3b07a10">__SPI_HandleTypeDef::hdmarx</a></div><div class="ttdeci">DMA_HandleTypeDef * hdmarx</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00142">stm32l4xx_hal_spi.h:142</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a5617a3a7983aedb0d214f318062ebc48"><div class="ttname"><a href="group__SPI__Exported__Types.html#a5617a3a7983aedb0d214f318062ebc48">__SPI_HandleTypeDef::TxXferSize</a></div><div class="ttdeci">uint16_t TxXferSize</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00124">stm32l4xx_hal_spi.h:124</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gab876e62eb52d15157fc0198109299ecb"><div class="ttname"><a href="group__SPI__Private__Functions.html#gab876e62eb52d15157fc0198109299ecb">SPI_DMAAbortOnError</a></div><div class="ttdeci">static void SPI_DMAAbortOnError(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI communication abort callback, when initiated by HAL services on Error (To be called at end of...</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03259">stm32l4xx_hal_spi.c:3259</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga4a855158eb976bf81d4afd2fec94dca2"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga4a855158eb976bf81d4afd2fec94dca2">SPI_RxISR_16BIT</a></div><div class="ttdeci">static void SPI_RxISR_16BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Manage the 16-bit receive in Interrupt context.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03699">stm32l4xx_hal_spi.c:3699</a></div></div>
<div class="ttc" id="agroup__RTCEx__Exported__Functions__Group2_html_ga05dcbf41f5c5e42a592e9ad9e351391e"><div class="ttname"><a href="group__RTCEx__Exported__Functions__Group2.html#ga05dcbf41f5c5e42a592e9ad9e351391e">HAL_OK</a></div><div class="ttdeci">return HAL_OK</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__rtc__ex_8c_source.html#l00885">stm32l4xx_hal_rtc_ex.c:885</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga4a1f3d4a85c87ed905ec45c42a98497c"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga4a1f3d4a85c87ed905ec45c42a98497c">SPI_2linesTxISR_16BIT</a></div><div class="ttdeci">static void SPI_2linesTxISR_16BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Tx 16-bit handler for Transmit and Receive in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03589">stm32l4xx_hal_spi.c:3589</a></div></div>
<div class="ttc" id="agroup__DMA__Exported__Functions__Group2_html_ga7eddc0931ac8a3d77b23d6d5e68407c7"><div class="ttname"><a href="group__DMA__Exported__Functions__Group2.html#ga7eddc0931ac8a3d77b23d6d5e68407c7">HAL_DMA_Start_IT</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_DMA_Start_IT(DMA_HandleTypeDef *hdma, uint32_t SrcAddress, uint32_t DstAddress, uint32_t DataLength)</div><div class="ttdoc">Start the DMA Transfer with interrupt enabled.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8c_source.html#l00473">stm32l4xx_hal_dma.c:473</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_aa3e13040cc9ea19050d21818bccd49c9"><div class="ttname"><a href="group__SPI__Exported__Types.html#aa3e13040cc9ea19050d21818bccd49c9">__SPI_HandleTypeDef::State</a></div><div class="ttdeci">__IO HAL_SPI_StateTypeDef State</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00146">stm32l4xx_hal_spi.h:146</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_gga8891cb64e76198a860172d94c638c9b4a9dae2883ae3e43ca28afc9453a14c938"><div class="ttname"><a href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a9dae2883ae3e43ca28afc9453a14c938">HAL_SPI_STATE_BUSY_TX_RX</a></div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00108">stm32l4xx_hal_spi.h:108</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a383178b03c80ede5782c6ef0a890446a"><div class="ttname"><a href="group__SPI__Exported__Types.html#a383178b03c80ede5782c6ef0a890446a">__SPI_HandleTypeDef::AbortCpltCallback</a></div><div class="ttdeci">void(* AbortCpltCallback)(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00158">stm32l4xx_hal_spi.h:158</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gaf4c16723d9962429218ad5cb9f9d2f48"><div class="ttname"><a href="group__SPI__Private__Functions.html#gaf4c16723d9962429218ad5cb9f9d2f48">SPI_WaitFlagStateUntilTimeout</a></div><div class="ttdeci">static HAL_StatusTypeDef SPI_WaitFlagStateUntilTimeout(SPI_HandleTypeDef *hspi, uint32_t Flag, FlagStatus State, uint32_t Timeout, uint32_t Tickstart)</div><div class="ttdoc">Handle SPI Communication Timeout.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03787">stm32l4xx_hal_spi.c:3787</a></div></div>
<div class="ttc" id="agroup__DMA__Exported__Functions__Group2_html_ga001f9fb04328a7460f9ff16908ff987c"><div class="ttname"><a href="group__DMA__Exported__Functions__Group2.html#ga001f9fb04328a7460f9ff16908ff987c">HAL_DMA_Abort</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_DMA_Abort(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">Abort the DMA Transfer.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__dma_8c_source.html#l00546">stm32l4xx_hal_dma.c:546</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a4446bdc11698f861edf37b72cf437aeb"><div class="ttname"><a href="group__SPI__Exported__Types.html#a4446bdc11698f861edf37b72cf437aeb">__SPI_HandleTypeDef::TxISR</a></div><div class="ttdeci">void(* TxISR)(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00138">stm32l4xx_hal_spi.h:138</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga59e2fa8b8f7ad87289bf02ae2ba5b8cb"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga59e2fa8b8f7ad87289bf02ae2ba5b8cb">SPI_DMATransmitCplt</a></div><div class="ttdeci">static void SPI_DMATransmitCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI transmit process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l02941">stm32l4xx_hal_spi.c:2941</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a67e721440b3449d544a27cfd7726c920"><div class="ttname"><a href="group__SPI__Exported__Types.html#a67e721440b3449d544a27cfd7726c920">__SPI_HandleTypeDef::RxXferCount</a></div><div class="ttdeci">__IO uint16_t RxXferCount</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00132">stm32l4xx_hal_spi.h:132</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga77fa5dac63b08379f35895c7b385adee"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga77fa5dac63b08379f35895c7b385adee">SPI_2linesRxISR_16BIT</a></div><div class="ttdeci">static void SPI_2linesRxISR_16BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Rx 16-bit handler for Transmit and Receive in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03537">stm32l4xx_hal_spi.c:3537</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gaad48e61b3c8df5c985ee474f5e3947e8"><div class="ttname"><a href="group__SPI__Private__Functions.html#gaad48e61b3c8df5c985ee474f5e3947e8">SPI_DMAError</a></div><div class="ttdeci">static void SPI_DMAError(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI communication error callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03236">stm32l4xx_hal_spi.c:3236</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926"><div class="ttname"><a href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4abb3992c67a15c14bd1808ef6b63fa926">HAL_SPI_STATE_READY</a></div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00104">stm32l4xx_hal_spi.h:104</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga73b6a4c1fca7e5935a256c4bc3258c6d"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga73b6a4c1fca7e5935a256c4bc3258c6d">SPI_DMAHalfTransmitCplt</a></div><div class="ttdeci">static void SPI_DMAHalfTransmitCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI half transmit process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03182">stm32l4xx_hal_spi.c:3182</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga07d334c19b44ac0ce9c71e92d0bdeb9b"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga07d334c19b44ac0ce9c71e92d0bdeb9b">SPI_DMAHalfTransmitReceiveCplt</a></div><div class="ttdeci">static void SPI_DMAHalfTransmitReceiveCplt(DMA_HandleTypeDef *hdma)</div><div class="ttdoc">DMA SPI half transmit receive process complete callback.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03218">stm32l4xx_hal_spi.c:3218</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_aa770b67ee3966c0aa7409f64b3b99bd8"><div class="ttname"><a href="group__SPI__Exported__Types.html#aa770b67ee3966c0aa7409f64b3b99bd8">__SPI_HandleTypeDef::pRxBuffPtr</a></div><div class="ttdeci">uint8_t * pRxBuffPtr</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00128">stm32l4xx_hal_spi.h:128</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga5e9b0e9bb7cca9482717d55ebee0a290"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga5e9b0e9bb7cca9482717d55ebee0a290">SPI_2linesRxISR_8BIT</a></div><div class="ttdeci">static void SPI_2linesRxISR_8BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Rx 8-bit handler for Transmit and Receive in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03412">stm32l4xx_hal_spi.c:3412</a></div></div>
<div class="ttc" id="agroup__RTCEx__Exported__Functions__Group2_html_ga88b8891e30e4b1c54fecb1235c95870d"><div class="ttname"><a href="group__RTCEx__Exported__Functions__Group2.html#ga88b8891e30e4b1c54fecb1235c95870d">__HAL_LOCK</a></div><div class="ttdeci">__HAL_LOCK(hrtc)</div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_ga8891cb64e76198a860172d94c638c9b4"><div class="ttname"><a href="group__SPI__Exported__Types.html#ga8891cb64e76198a860172d94c638c9b4">HAL_SPI_StateTypeDef</a></div><div class="ttdeci">HAL_SPI_StateTypeDef</div><div class="ttdoc">HAL SPI State structure definition.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00101">stm32l4xx_hal_spi.h:101</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a5247eb0463437c9980a9d4a5300b50a5"><div class="ttname"><a href="group__SPI__Exported__Types.html#a5247eb0463437c9980a9d4a5300b50a5">SPI_InitTypeDef::Mode</a></div><div class="ttdeci">uint32_t Mode</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00049">stm32l4xx_hal_spi.h:49</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga209ef1a70d869a1834101dc3ff971349"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga209ef1a70d869a1834101dc3ff971349">SPI_AbortRx_ISR</a></div><div class="ttdeci">static void SPI_AbortRx_ISR(SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Handle abort a Rx transaction.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l04146">stm32l4xx_hal_spi.c:4146</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a97e276bfd322a6028cbac7408cf8e610"><div class="ttname"><a href="group__SPI__Exported__Types.html#a97e276bfd322a6028cbac7408cf8e610">__SPI_HandleTypeDef::Instance</a></div><div class="ttdeci">SPI_TypeDef * Instance</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00118">stm32l4xx_hal_spi.h:118</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Functions__Group2_html_ga518c43d8323499451e7f4782a9dc6e32"><div class="ttname"><a href="group__SPI__Exported__Functions__Group2.html#ga518c43d8323499451e7f4782a9dc6e32">HAL_SPI_TransmitReceive_IT</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_SPI_TransmitReceive_IT(SPI_HandleTypeDef *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size)</div><div class="ttdoc">Transmit and Receive an amount of data in non-blocking mode with Interrupt.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l01683">stm32l4xx_hal_spi.c:1683</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab"><div class="ttname"><a href="group__SPI__Exported__Types.html#gga8891cb64e76198a860172d94c638c9b4a5d82b644c7ca656ab5fe8a8e3cbc29ab">HAL_SPI_STATE_BUSY_TX</a></div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00106">stm32l4xx_hal_spi.h:106</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gabd2c3ffa402d32d49bc0683d39315eec"><div class="ttname"><a href="group__SPI__Private__Functions.html#gabd2c3ffa402d32d49bc0683d39315eec">SPI_RxISR_8BIT</a></div><div class="ttdeci">static void SPI_RxISR_8BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Manage the receive 8-bit in Interrupt context.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03647">stm32l4xx_hal_spi.c:3647</a></div></div>
<div class="ttc" id="agroup__RTCEx__Exported__Functions__Group2_html_ga2b23ae77e9ce099e35aaa5e9e0daba7b"><div class="ttname"><a href="group__RTCEx__Exported__Functions__Group2.html#ga2b23ae77e9ce099e35aaa5e9e0daba7b">assert_param</a></div><div class="ttdeci">assert_param(IS_RTC_WAKEUP_CLOCK(WakeUpClock))</div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_a186b770dda2e53c4e9a204cd50e17e74"><div class="ttname"><a href="group__SPI__Exported__Types.html#a186b770dda2e53c4e9a204cd50e17e74">__SPI_HandleTypeDef::TxXferCount</a></div><div class="ttdeci">__IO uint16_t TxXferCount</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00126">stm32l4xx_hal_spi.h:126</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga2197d57a17bb597bf6360c9951c4efc8"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga2197d57a17bb597bf6360c9951c4efc8">SPI_2linesTxISR_8BIT</a></div><div class="ttdeci">static void SPI_2linesTxISR_8BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Tx 8-bit handler for Transmit and Receive in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03490">stm32l4xx_hal_spi.c:3490</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_gab9d90dd02f6ca501885023df5d6ed4ba"><div class="ttname"><a href="group__SPI__Private__Functions.html#gab9d90dd02f6ca501885023df5d6ed4ba">SPI_EndRxTransaction</a></div><div class="ttdeci">static HAL_StatusTypeDef SPI_EndRxTransaction(SPI_HandleTypeDef *hspi, uint32_t Timeout, uint32_t Tickstart)</div><div class="ttdoc">Handle the check of the RX transaction complete.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03895">stm32l4xx_hal_spi.c:3895</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Functions__Group2_html_ga7c3106fe01493a33b08e5c617f45aeb1"><div class="ttname"><a href="group__SPI__Exported__Functions__Group2.html#ga7c3106fe01493a33b08e5c617f45aeb1">HAL_SPI_TransmitReceive</a></div><div class="ttdeci">HAL_StatusTypeDef HAL_SPI_TransmitReceive(SPI_HandleTypeDef *hspi, uint8_t *pTxData, uint8_t *pRxData, uint16_t Size, uint32_t Timeout)</div><div class="ttdoc">Transmit and Receive an amount of data in blocking mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l01197">stm32l4xx_hal_spi.c:1197</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga27117ecaaa02d6f682450a96375f252f"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga27117ecaaa02d6f682450a96375f252f">SPI_EndRxTxTransaction</a></div><div class="ttdeci">static HAL_StatusTypeDef SPI_EndRxTxTransaction(SPI_HandleTypeDef *hspi, uint32_t Timeout, uint32_t Tickstart)</div><div class="ttdoc">Handle the check of the RXTX or TX transaction complete.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03931">stm32l4xx_hal_spi.c:3931</a></div></div>
<div class="ttc" id="agroup__SPI__Exported__Types_html_adb2e52ab20ae5ae6b89532155fec99af"><div class="ttname"><a href="group__SPI__Exported__Types.html#adb2e52ab20ae5ae6b89532155fec99af">__SPI_HandleTypeDef::pTxBuffPtr</a></div><div class="ttdeci">uint8_t * pTxBuffPtr</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8h_source.html#l00122">stm32l4xx_hal_spi.h:122</a></div></div>
<div class="ttc" id="agroup__SPI__Private__Functions_html_ga61e8784d9e16109e064e2c28617e9af9"><div class="ttname"><a href="group__SPI__Private__Functions.html#ga61e8784d9e16109e064e2c28617e9af9">SPI_TxISR_8BIT</a></div><div class="ttdeci">static void SPI_TxISR_8BIT(struct __SPI_HandleTypeDef *hspi)</div><div class="ttdoc">Handle the data 8-bit transmit in Interrupt mode.</div><div class="ttdef"><b>Definition:</b> <a href="stm32l4xx__hal__spi_8c_source.html#l03732">stm32l4xx_hal_spi.c:3732</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
